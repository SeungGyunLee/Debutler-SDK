services:
  # 스프링 부트 앱
  sdk-app:
    container_name: sdk-app
    build: .
    image: sdk-app
    ports:
      - "8080:8080"
    environment:

      SPRING_DATASOURCE_URL: "jdbc:mysql://my-mysql:3306/knot_service?serverTimezone=Asia/Seoul&characterEncoding=UTF-8&useSSL=false&allowPublicKeyRetrieval=true"
      SPRING_DATASOURCE_USERNAME: "root"
      SPRING_DATASOURCE_PASSWORD: "root"
    depends_on:
      - mysql-db

  # 도커용 MySQL
  mysql-db:
    image: mysql:8.0
    container_name: my-mysql
    ports:
      - "3306:3306"
    environment:
      MYSQL_DATABASE: knot_service # (기왕이면 여기도 메인 DB 이름으로 변경)
      MYSQL_ROOT_PASSWORD: root
      MYSQL_USER: dev_user
      MYSQL_PASSWORD: dev_password
    volumes:
      - db_data:/var/lib/mysql

volumes:
  db_data: